import{r as u,t as le,aO as ae,s as te,ac as ne,ad as oe,a1 as de,H as re,a2 as ue,D as se,G as ie,aS as pe,ah as _e,ai as ce,I as me,L as fe,au as ve,aL as ge,f as k,j as e,k as a,w as x,l as p,m as I,o as r,F as w,B as D,q as _,C as $,g as O,h as d,aR as he,_ as be,E as T,Z as ke}from"./vendor.3bf6c43c.js";/* empty css                   *//* empty css                        */import{l as xe,g as Ve,u as Ee,a as Ne,d as ye}from"./dept.809af28b.js";import{_ as Ce,f as Ie}from"./index.3091a82d.js";import{l as we}from"./role.c07df151.js";const De={class:"app-container"},Te=_("\u5C55\u5F00/\u6298\u53E0"),Be=_("\u4FEE\u6539"),Ue=_("\u65B0\u589E"),je=_("\u5220\u9664"),Re={class:"dialog-footer"},qe=_("\u786E \u5B9A"),Le=_("\u53D6 \u6D88"),Fe={setup($e){const B=u([]),s=u(!1),V=u(!0);u(!0);const E=u(""),v=u([]);u([]);const N=u(!0),y=u(!0),U=u([]),S=le({form:{},rules:{parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],deptName:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderNum:[{required:!0,message:"\u663E\u793A\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],leader_id:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],phone:[{required:!0,pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}}),{proxy:j}=he(),{form:o,rules:A}=ae(S);function g(){V.value=!0,xe().then(n=>{B.value=j.handleTree(n.data,"_id"),V.value=!1})}function P(){s.value=!1,C()}function C(){o.value={_id:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader_id:void 0,phone:void 0,roleIds:void 0}}const M=n=>{if(v.value.length!==0)return v.value.filter(t=>t._id===n)[0].roleName};function G(n){C(),n!=null&&(o.value.parentId=n._id),s.value=!0,E.value="\u6DFB\u52A0\u90E8\u95E8"}function H(){y.value=!1,N.value=!N.value,be(()=>{y.value=!0})}function Z(n){C(),Ve(n._id).then(t=>{o.value=t.data,s.value=!0,E.value="\u4FEE\u6539\u90E8\u95E8"})}function z(){j.$refs.deptRef.validate(n=>{n&&(o.value._id!=null?Ee(o.value).then(t=>{T.success("\u4FEE\u6539\u6210\u529F"),s.value=!1,g()}):Ne(o.value).then(t=>{T.success("\u65B0\u589E\u6210\u529F"),s.value=!1,g()}))})}function J(n){ke.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u540D\u79F0\u4E3A"'+n.deptName+'"\u7684\u6570\u636E\u9879?',"\u7CFB\u7EDF\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){return ye(n._id)}).then(()=>{g(),T.success("\u5220\u9664\u6210\u529F")}).catch(()=>{})}return g(),Ie().then(n=>{n.data.forEach(t=>{U.value.push({label:t.name,value:t._id})})}),we().then(n=>v.value=n.data),(n,t)=>{const c=te,m=ne,R=oe,i=de,K=re,Q=ue,q=se,f=ie,W=pe,L=_e,F=ce,X=me,Y=fe,h=ve("hasPermi"),ee=ge;return r(),k("div",De,[e(R,{gutter:10,class:"mb8"},{default:a(()=>[e(m,{span:1.5},{default:a(()=>[e(c,{type:"info",plain:"",icon:"Sort",onClick:H},{default:a(()=>[Te]),_:1})]),_:1},8,["span"])]),_:1}),y.value?x((r(),p(Q,{key:0,data:B.value,"row-key":"_id","default-expand-all":N.value,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:a(()=>[e(i,{prop:"deptName",label:"\u90E8\u95E8\u540D\u79F0"}),e(i,{prop:"orderNum",label:"\u6392\u5E8F"}),e(i,{prop:"leader_name",label:"\u8D1F\u8D23\u4EBA"}),e(i,{prop:"phone",label:"\u90E8\u95E8\u7535\u8BDD"}),e(i,{label:"\u89D2\u8272"},{default:a(l=>[(r(!0),k(w,null,D(l.row.roleIds,b=>(r(),p(K,{style:{margin:"0 2px"}},{default:a(()=>[_($(M(b)),1)]),_:2},1024))),256))]),_:1}),e(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime"},{default:a(l=>[O("span",null,$(l.row.createTime),1)]),_:1}),e(i,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[l.row.parentId?x((r(),p(c,{key:0,link:"",icon:"Edit",onClick:b=>Z(l.row)},{default:a(()=>[Be]),_:2},1032,["onClick"])),[[h,"1019"]]):I("",!0),x((r(),p(c,{link:"",icon:"Plus",onClick:b=>G(l.row)},{default:a(()=>[Ue]),_:2},1032,["onClick"])),[[h,"1018"]]),l.row.parentId?x((r(),p(c,{key:1,link:"",type:"danger",icon:"Delete",onClick:b=>J(l.row)},{default:a(()=>[je]),_:2},1032,["onClick"])),[[h,"1020"]]):I("",!0)]),_:1})]),_:1},8,["data","default-expand-all"])),[[ee,V.value],[h,"1017"]]):I("",!0),e(Y,{title:E.value,modelValue:s.value,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value=l),width:"600px","append-to-body":""},{footer:a(()=>[O("div",Re,[e(c,{type:"primary",onClick:z},{default:a(()=>[qe]),_:1}),e(c,{onClick:P},{default:a(()=>[Le]),_:1})])]),default:a(()=>[e(X,{ref:"deptRef",model:d(o),rules:d(A),"label-width":"80px"},{default:a(()=>[e(R,null,{default:a(()=>[e(m,{span:12},{default:a(()=>[e(f,{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{default:a(()=>[e(q,{modelValue:d(o).deptName,"onUpdate:modelValue":t[0]||(t[0]=l=>d(o).deptName=l),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(f,{label:"\u663E\u793A\u6392\u5E8F",prop:"orderNum"},{default:a(()=>[e(W,{modelValue:d(o).orderNum,"onUpdate:modelValue":t[1]||(t[1]=l=>d(o).orderNum=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(f,{label:"\u8D1F\u8D23\u4EBA",prop:"leader_id"},{default:a(()=>[e(F,{modelValue:d(o).leader_id,"onUpdate:modelValue":t[2]||(t[2]=l=>d(o).leader_id=l),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(r(!0),k(w,null,D(U.value,l=>(r(),p(L,{key:l._id,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(f,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"phone"},{default:a(()=>[e(q,{modelValue:d(o).phone,"onUpdate:modelValue":t[3]||(t[3]=l=>d(o).phone=l),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u7535\u8BDD",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(f,{label:"\u89D2\u8272"},{default:a(()=>[e(F,{modelValue:d(o).roleIds,"onUpdate:modelValue":t[4]||(t[4]=l=>d(o).roleIds=l),multiple:"",placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(r(!0),k(w,null,D(v.value,l=>(r(),p(L,{key:l._id,label:l.roleName,value:l._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}};var He=Ce(Fe,[["__scopeId","data-v-1eedd402"]]);export{He as default};
